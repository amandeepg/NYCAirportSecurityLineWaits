plugins {
    id 'com.android.application'
    id 'org.jetbrains.kotlin.android'
    id 'kotlin-parcelize'
    id 'org.jmailen.kotlinter'
    id 'com.google.devtools.ksp'
    id 'app.cash.licensee'
    id 'app.cash.paparazzi'
}

android {
    compileSdk 34

    defaultConfig {
        applicationId "ca.amandeep.nycairportsecuritylinewaits"
        minSdk 29
        targetSdk 34
        versionCode 1
        versionName "1.0"

        vectorDrawables {
            useSupportLibrary true
        }
        signingConfig signingConfigs.debug
    }

    buildTypes {
        release {
            minifyEnabled true
            shrinkResources true
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
        }
    }
    kotlin {
        jvmToolchain(11)
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_11
        targetCompatibility JavaVersion.VERSION_11
    }
    kotlinOptions {
        jvmTarget = '11'
        freeCompilerArgs += "-Xopt-in=kotlin.RequiresOptIn"
        freeCompilerArgs += "-P"
        freeCompilerArgs += "plugin:androidx.compose.compiler.plugins.kotlin:metricsDestination=" + project.buildDir.absolutePath + "/compose_compiler"
        freeCompilerArgs += "-P"
        freeCompilerArgs += "plugin:androidx.compose.compiler.plugins.kotlin:reportsDestination=" + project.buildDir.absolutePath + "/compose_compiler"
    }
    buildFeatures {
        compose true
    }
    composeOptions {
        kotlinCompilerExtensionVersion compose_version
    }
    packagingOptions {
        resources {
            excludes += '/META-INF/{AL2.0,LGPL2.1}'
        }
    }
    namespace 'ca.amandeep.nycairportsecuritylinewaits'
}

dependencies {
    implementation AndroidX.activity.compose
    implementation AndroidX.constraintLayout.compose
    implementation AndroidX.compose.material3
    implementation AndroidX.compose.material3.windowSizeClass
    implementation AndroidX.compose.material
    implementation AndroidX.compose.ui
    implementation AndroidX.core.ktx
    implementation AndroidX.core.splashscreen
    implementation AndroidX.lifecycle.runtime.compose
    implementation AndroidX.lifecycle.runtime.ktx
    implementation AndroidX.lifecycle.viewModelKtx
    implementation AndroidX.navigation.compose
    implementation KotlinX.collections.immutable
    implementation AndroidX.compose.material.icons.extended

    implementation Square.moshi.adapters
    implementation Square.moshi
    ksp Square.moshi.kotlinCodegen
    implementation Square.retrofit2.converter.moshi
    implementation Square.retrofit2

    implementation 'com.github.ajalt:timberkt:_'
    implementation JakeWharton.timber

    implementation AndroidX.compose.ui.tooling
    debugImplementation AndroidX.compose.ui.toolingPreview
}

licensee {
    allow 'Apache-2.0'
    allowUrl('https://developer.android.com/studio/terms.html') {
        because 'Android Software Development Kit License Agreement'
    }
}

tasks.withType(Test) {
    android.sourceSets.main.res.srcDirs += 'src/test/res'
}
